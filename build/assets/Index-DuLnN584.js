import{r as i,W as T,j as e,Y,a as m,B as x,y as M}from"./app-CJlbE-LF.js";import{P as J}from"./Page-yreOlTT-.js";import{W as K,B as S,P as O,d as Q,e as V,f as X,H as Z,g as ee,h as se,i as te,U as ae,C as re,I as le,F as ne,l as ce,M as ie,j as de,k as oe}from"./Webmaster-DrX7rw6O.js";import{D as _}from"./DeleteModal-BGxUlct8.js";import{R as me}from"./react-loading-C6WYhK2V.js";import{h as w}from"./button-Bh2k_5J8.js";import"./createLucideIcon-jxw-JyEv.js";import"./facebook-DXNOz92s.js";import"./save-DB3l4sw9.js";import"./transition-NcVCD9Y2.js";import"./render-BcGX6XVe.js";import"./Modal-TtpclOUU.js";import"./disabled-BPakW4IL.js";const Me=({auth:L,groups:o,from:xe,to:he,total:ge,menu:I})=>{const[E,h]=i.useState(!1),[g,N]=i.useState(!1),[y,A]=i.useState(!1),[F,p]=i.useState(!1),[B,b]=i.useState(!1),u=T({template:0}),j=T({group:0}),[a,G]=i.useState(o.length>0?o[0]:null),[l,v]=i.useState(o.length>0?o[0].templates:[]),P=s=>{const t=Date.now()-s,r=60*1e3,f=60*r,k=24*f;return t<r?"few seconds ago":t<f?`${Math.floor(t/r)} minutes ago`:t<k?`${Math.floor(t/f)} hours ago`:`${Math.floor(t/k)} days ago`},d=l.length>0?l.reduce((s,n)=>new Date(n.updated_at).getTime()>new Date(s.updated_at).getTime()?n:s):null,R=d&&d.updated_by?d.updated_by.name:"",$=d?P(new Date(d.updated_at).getTime()):"",H=async()=>{b(!0);try{await u.delete(route("templates.destroy",{id:u.data.template})),x.success("Template has been deleted successfully"),M.get(route("templates.index"))}catch(s){x.error("Error deleting the template"),console.error("Error details:",s)}finally{b(!1),p(!1)}},W=async()=>{N(!0);try{await j.delete(route("templates.groups.destroy",{id:j.data.group})),x.success("Group of templates has been deleted successfully"),M.get(route("templates.index"))}catch(s){x.error("Error deleting the group of templates"),console.error("Error details:",s)}finally{N(!1),h(!1)}},q=(s,n)=>{s.preventDefault(),j.setData({group:n}),h(!0)},U=(s,n)=>{s.preventDefault(),u.setData({template:n}),p(!0)},D=()=>{h(!1),p(!1)};i.useEffect(()=>{v(a?a.templates:[])},[a]);const z=s=>{A(s.target.value!="");const n=a?a.templates:[],t=s.target.value.toLowerCase(),c=n.filter(r=>r.name&&r.name.toLowerCase().includes(t)||r.description&&r.description.toLowerCase().includes(t)||r.created_by&&r.created_by.name.toLowerCase().includes(t)||r.stringphotos&&r.stringphotos.toLowerCase().includes(t)||r.stringvideos&&r.stringvideos.toLowerCase().includes(t)||r.stringaudios&&r.stringaudios.toLowerCase().includes(t)||r.message&&r.message.toLowerCase().includes(t));v(c)};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Templates"}),e.jsx(K,{user:L.user,menu:I,breadcrumb:e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Templates"}),children:e.jsx(J,{title:"Templates",header:e.jsx(e.Fragment,{}),children:e.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-8",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-3 2xl:col-span-2",children:[e.jsx("h2",{className:"intro-y text-lg font-medium mr-auto mt-2",children:"Groups"}),e.jsxs("div",{className:"intro-y box bg-primary p-5 mt-6",children:[e.jsxs(m,{href:route("templates.groups.create"),type:"button",className:"btn text-slate-600 dark:text-slate-300 w-full bg-white dark:bg-darkmode-300 dark:border-darkmode-300 mt-1",children:[e.jsx(S,{className:"w-4 h-4 mr-2"})," Create a group"]}),a&&e.jsxs(m,{href:route("templates.groups.edit",a.id),className:"btn text-slate-600 dark:text-slate-300 w-full bg-white dark:bg-darkmode-300 dark:border-darkmode-300 mt-1",children:[e.jsx(O,{className:"w-4 h-4 mr-2 text-danger"})," Edit the group"]}),a&&e.jsx(w,{onClick:s=>q(s,a.id),disabled:g,className:"btn text-slate-600 dark:text-slate-300 w-full dark:bg-darkmode-300 dark:border-darkmode-300 mt-1 bg-white",children:g?e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{type:"spin",color:"#ff",height:24,width:24}),e.jsx("span",{className:"ml-2",children:"Deleting..."})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2 text-red-500"}),e.jsx("span",{children:"Delete the group"})]})}),e.jsx("div",{className:"border-t border-white/10 dark:border-darkmode-400 mt-6 pt-6 text-white",children:o.map(s=>{const n=a&&s.id===a.id;return e.jsxs(w,{onClick:()=>G(s),className:`flex items-center px-3 py-2 rounded-md mt-2 ${n?"bg-white/10 dark:bg-darkmode-700 font-medium":""}`,children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),s.name]},s.name)})})]})]}),e.jsxs("div",{className:"col-span-12 lg:col-span-9 2xl:col-span-10",children:[e.jsxs("div",{className:"intro-y flex flex-col-reverse sm:flex-row items-center",children:[e.jsxs("div",{className:"w-full sm:w-auto relative mr-auto mt-3 sm:mt-0",children:[e.jsx(V,{className:"w-4 h-4 absolute my-auto inset-y-0 ml-3 left-0 z-10 text-slate-500"}),e.jsx("input",{type:"text",className:"form-control w-full sm:w-64 box px-10",placeholder:"Search template",onChange:z}),e.jsx("div",{className:"inbox-filter dropdown absolute inset-y-0 mr-3 right-0 flex items-center","data-tw-placement":"bottom-start",children:e.jsx(X,{className:"dropdown-toggle w-4 h-4 cursor-pointer text-slate-500",role:"button","aria-expanded":"false","data-tw-toggle":"dropdown"})})]}),e.jsx("div",{className:"w-full sm:w-auto flex",children:e.jsx(m,{href:route("templates.create"),className:"btn btn-primary shadow-md mr-2",children:"Create a Template"})})]}),e.jsx("div",{className:"intro-y overflow-auto",children:e.jsxs("table",{className:"table table-report -mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"whitespace-nowrap",children:"#"}),e.jsx("th",{className:"whitespace-nowrap",children:"Template"}),e.jsx("th",{className:"whitespace-nowrap",children:"Created"}),e.jsx("th",{className:"whitespace-nowrap",children:"Messages"}),e.jsx("th",{className:"whitespace-nowrap",children:"Rates"}),e.jsx("th",{className:"whitespace-nowrap",children:"Action"})]})}),e.jsx("tbody",{children:l&&l.map((s,n)=>e.jsxs("tr",{className:"intro-x",children:[e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.id})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.group.name})]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.name})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.description&&s.description.length>10?s.description.substring(0,10)+"...":s.description})]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.created_by.name})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(re,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsxs("td",{children:[s.photos.map((t,c)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:e.jsx("a",{target:"_blank",href:t,children:t.length>10?t.substring(0,10)+"...":t})})]},c)),s.videos.map((t,c)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:e.jsx("a",{target:"_blank",href:t,children:t.length>10?t.substring(0,10)+"...":t})})]},c)),s.audios.map((t,c)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:e.jsx("a",{target:"_blank",href:t,children:t.length>10?t.substring(0,10)+"...":t})})]},c)),s.message&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.message})]})]}),e.jsxs("td",{children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-primary",children:s.total_used})}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-warning",children:s.total_responses})}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-success",children:s.total_orders})})]}),e.jsx("td",{className:"table-report__action w-56",children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsxs(m,{className:"flex items-center mr-3",href:route("templates.edit",{template:s.id}),children:[e.jsx(de,{className:"w-4 h-4 mr-1"})," Edit"]}),e.jsxs(w,{className:"flex items-center text-danger",onClick:t=>U(t,s.id),children:[e.jsx(oe,{className:"w-4 h-4 mr-1"})," Delete"]})]})})]},n))})]})}),e.jsx(_,{showDeleteModal:F,handleDeleteCancel:D,handleDeleteConfirm:H,deleting:B}),e.jsx(_,{showDeleteModal:E,handleDeleteCancel:D,handleDeleteConfirm:W,deleting:g}),e.jsxs("div",{className:"p-5 flex flex-col sm:flex-row items-center text-center sm:text-left text-slate-500",children:[!a&&e.jsx("div",{children:"No group !"}),a&&l.length>0&&e.jsxs("div",{children:[l==null?void 0:l.length," of ",l==null?void 0:l.length," in ",a==null?void 0:a.name]}),a&&l.length<=0&&!y&&e.jsxs("div",{children:["No templates in ",a==null?void 0:a.name," !"]}),a&&l.length<=0&&y&&e.jsxs("div",{children:["No results has been found in ",a==null?void 0:a.name," !"]}),d&&e.jsxs("div",{className:"sm:ml-auto mt-2 sm:mt-0",children:["Last activity: ",$," by ",R]})]})]})]})})})]})};export{Me as default};
